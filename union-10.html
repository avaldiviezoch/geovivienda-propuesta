<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GeoVivienda — Propuesta (menú fijo + carátula + cifras + Geovisor)</title>
  <meta name="color-scheme" content="light dark" />
  <!-- Fuente global: Nunito Sans (todo menos el título grande) -->
  <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@400;600;700;800;900&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#fff6f3; --ink:#1d212a; --muted:#5e6472; --stroke:#e6e0de;
      --brand:#c62a4b; --brand-ink:#fff; --glass: color-mix(in srgb, #ffffff 65%, transparent);
      --maxw: 1200px;
      --rojo:#e85564; --rojo2:#ff847c;
      --card-h:260px; --hdr-h:72px; --gap:24px; --radius:12px;
      --elev0:0 4px 8px rgba(0,0,0,.10); --elev1:0 10px 18px rgba(0,0,0,.18);
      --header-h: 82px;             /* altura del header */
      --page-bg: #F6E1DE;           /* color uniforme del fondo (igual al de Geovisor) */
    }

    *{box-sizing:border-box}
    html,body{margin:0;height:100%;scroll-behavior:smooth}
    html{scroll-padding-top:var(--header-h)} /* compensación anclas */

    /* === Fuente global Nunito Sans === */
    body{
      font-family: "Nunito Sans", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: var(--page-bg);
      color:var(--ink);
      padding-top: var(--header-h);             /* evita que el header fijo tape el contenido */
    }

    /* HEADER fijo en toda la página */
    header.site{
      position:fixed; top:0; left:0; right:0; z-index:1000; height: var(--header-h);
      backdrop-filter:saturate(140%) blur(8px);
      background:var(--glass);
      border-bottom:1px solid var(--stroke);
      box-shadow:0 2px 8px rgba(0,0,0,.05);
      transition:box-shadow .25s ease, background-color .25s ease, border-color .25s ease;
    }
    header.site.scrolled{
      box-shadow:0 8px 24px rgba(0,0,0,.12);
      background: color-mix(in srgb, #ffffff 78%, transparent);
      border-color: color-mix(in srgb, var(--stroke) 80%, #000 20%);
    }

    .navwrap{
      max-width:var(--maxw); margin-inline:auto;
      padding:clamp(8px,2.4vw,14px) clamp(12px,3.6vw,24px);
      display:grid; grid-template-columns:auto 1fr auto; align-items:center; gap:14px; height:100%;
    }
    .logo{display:flex; align-items:center; gap:.6rem; text-decoration:none; color:inherit; transition:transform .3s}
    .logo:hover{transform:scale(1.05)}
    .logo img{height:36px; width:auto; border-radius:10px; border:1px solid var(--stroke); background:#fff; transition:box-shadow .3s}
    .logo:hover img{box-shadow:0 0 12px rgba(198,42,75,.3)}
    .logo span{font-weight:800}

    nav{justify-self:center}
    nav ul{list-style:none; display:flex; gap:clamp(8px,1.8vw,14px); margin:0; padding:0; flex-wrap:wrap; align-items:center; justify-content:center}
    nav a{
      --pad-x:.9rem; --pad-y:.5rem;
      text-decoration:none; color:inherit; font-weight:800; letter-spacing:.2px; opacity:.95;
      padding:var(--pad-y) var(--pad-x); border-radius:999px; position:relative; transition:all .22s;
    }
    nav a:hover{ background:#fff8; transform:translateY(-1px); box-shadow:0 4px 12px rgba(198,42,75,.16) }
    nav a.active{
      background:var(--rojo); color:#fff; box-shadow:0 10px 24px rgba(232,85,100,.30);
    }
    nav a.active::after{
      content:""; position:absolute; inset:-4px; border-radius:999px; pointer-events:none;
      box-shadow:0 0 0 0 rgba(232,85,100,.45); animation:ringPulse 1.4s ease-out forwards;
    }
    @keyframes ringPulse{ 0%{box-shadow:0 0 0 0 rgba(232,85,100,.45);opacity:1} 100%{box-shadow:0 0 0 22px rgba(232,85,100,0);opacity:0} }

    .btn{
      display:inline-flex; align-items:center; gap:.5rem; font-weight:700;
      padding:.6rem 1rem; border-radius:999px; border:1px solid var(--brand);
      background:var(--brand); color:var(--brand-ink); text-decoration:none;
      box-shadow:0 8px 20px rgba(198,42,75,.18); transition:all .3s; animation:pulse 2s ease-in-out infinite;
    }
    .btn:hover{ transform:scale(1.05); box-shadow:0 10px 24px rgba(198,42,75,.3) }
    @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.03)}}

    /* COVER (hero + textos/cifras/ramificación) con el mismo fondo uniforme */
    .cover{
      position:relative; min-height: clamp(580px, 90dvh, 880px);
      background: var(--page-bg);
      overflow:visible; border-bottom:1px solid var(--stroke);
    }
    .cover .container{
      max-width:var(--maxw); margin-inline:auto;
      padding:clamp(20px,5vw,40px) clamp(12px,3.6vw,24px);
      display:grid; align-items:center; gap:clamp(16px,4vw,28px);
      grid-template-columns:1.2fr .9fr;
    }
    @media (max-width:980px){ .cover .container{ grid-template-columns:1fr } }

    /* === Título grande: mantener fuente original del sistema, NO Nunito === */
    .title{
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
      font-size:clamp(28px,5vw,64px); line-height:1.04; margin:.2rem 0 .6rem; font-weight:800; opacity:0; animation:fadeInUp 1s ease forwards
    }
    .title span{display:inline-block; opacity:0; transform:translateY(20px); animation:letterPop .6s ease forwards; animation-delay:calc(.05s * var(--i))}
    @keyframes fadeInUp{0%{opacity:0;transform:translateY(30px)}100%{opacity:1;transform:translateY(0)}}
    @keyframes letterPop{0%{opacity:0;transform:translateY(20px)}100%{opacity:1;transform:translateY(0)}}

    .subtitle{ color:var(--muted); font-size:clamp(14px,1.3vw,18px); max-width:68ch; opacity:0; animation:fadeInUp 1s ease forwards .5s }
    .actions{ display:flex; gap:.6rem; flex-wrap:wrap; margin-top:12px }
    .btn.ghost{ background:#fff; color:var(--ink); border-color:var(--stroke); animation:none }
    .btn.ghost:hover{ background: color-mix(in srgb, var(--brand) 10%, #fff); transform:scale(1.05) }
    .art{ position:relative; text-align:center }
    .art img{ width:100%; max-width:480px; height:auto; display:block; margin:auto; opacity:0; transform:scale(.8) rotate(-5deg); animation:artPop 1.2s ease forwards .6s, floaty 6s ease-in-out infinite 1.8s; position:relative; z-index:1 }
    @keyframes artPop{0%{opacity:0;transform:scale(.8) rotate(-5deg)}100%{opacity:1;transform:scale(1) rotate(0)}}
    @keyframes floaty{0%,100%{transform:translateY(0) rotate(0)}50%{transform:translateY(-12px) rotate(1deg)}}
    .cover::before{
      content:''; position:absolute; inset:0; background: radial-gradient(circle at 70% 20%, rgba(198,42,75,.2) 0%, transparent 50%);
      opacity:0; animation:particleBurst 2s ease-out forwards 1s; pointer-events:none; z-index:0;
    }
    @keyframes particleBurst{0%{opacity:0;transform:scale(.5)}50%{opacity:.4}100%{opacity:0;transform:scale(1.5)}}

    /* Textos/cifras/ramificación */
    .info-apartado{
      max-width:var(--maxw); margin-inline:auto; padding:clamp(18px,4vw,34px) clamp(12px,3.6vw,24px);
      background: linear-gradient(to bottom, rgba(255,255,255,0) 0%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0) 100%);
      text-align:center; font-size:clamp(14px,1.6vw,18px); line-height:1.6; color:color-mix(in srgb, var(--muted) 90%, #000 10%);
      text-shadow:0 1px 0 rgba(255,255,255,.6); opacity:0; transform:translateY(10px); animation:fadeSlideUp 1s ease forwards 1.0s;
    }
    @keyframes fadeSlideUp{0%{opacity:0;transform:translateY(10px)}100%{opacity:1;transform:translateY(0)}}

    .stats{
      background: linear-gradient(to bottom, var(--rojo) 0%, var(--brand) 100%);
      color:var(--brand-ink);
      padding: clamp(42px, 7vw, 88px) clamp(18px, 5vw, 42px);
      text-align:center;
      /* Antes tenía 'Forum'. Ahora hereda Nunito Sans. */
      opacity:0; transform:translateY(30px); animation:fadeSlideUp 1s ease forwards 1.5s;
    }
    .stats .wrap{ max-width:var(--maxw); margin:0 auto }
    .stats h2{ margin:0 0 clamp(26px, 3.8vw, 44px); font-size:clamp(22px,3.4vw,40px); font-weight:800; letter-spacing:.2px }
    .kpis{ display:grid; grid-template-columns: 1fr auto 1fr auto 1fr auto 1fr; gap:clamp(14px,3.4vw,34px); align-items:center }
    .kpi-sep{ display:flex; align-items:center; justify-content:center; font-size:clamp(22px,3.2vw,34px); line-height:1; user-select:none }
    @media (max-width:900px){ .kpis{grid-template-columns:1fr} .kpi-sep{display:none} }
    .counter{ display:flex; flex-direction:column; align-items:center; gap:10px }
    .slot{ display:inline-flex; align-items:baseline; line-height:1; gap:.26em }
    .digit{ font-variant-numeric:tabular-nums; font-weight:800; font-size:clamp(28px,5vw,48px); letter-spacing:.01em; min-width:.60em; text-align:center; text-shadow:0 1px 2px rgba(0,0,0,.12) }
    .sep{ font-weight:800; font-size:clamp(28px,5vw,48px); margin:0 .14em; line-height:1; display:inline-flex; align-items:center; justify-content:center; text-shadow:0 1px 2px rgba(0,0,0,.12) }
    .label{ font-size:clamp(12px,1.6vw,15px); opacity:.95 } .footnote{ margin-top:clamp(18px,3vw,26px); font-size:11px; opacity:.9 }

    .conector{width:680px;margin:40px auto 32px;position:relative;isolation:isolate;z-index:0}
    .fila{display:flex;justify-content:space-between;position:relative}
    .nodo{ position:relative;width:200px;height:200px;border-radius:16px;border:2px solid #e0e0e0;
      background: linear-gradient(to bottom, #fff, color-mix(in srgb, #fff 80%, var(--rojo) 20%));
      display:flex;align-items:center;justify-content:center;box-shadow:0 2px 8px rgba(0,0,0,.1);z-index:1 }
    .nodo img{width:100%;height:100%;object-fit:cover;object-position:center;border-radius:14px;position:relative;z-index:2}
    .fila.superior::before,.fila.superior::after{ content:"";position:absolute;top:50%;height:4px;background: linear-gradient(to right, transparent, var(--rojo), transparent);transform:scaleX(0);z-index:-1 }
    .conector.visible .fila.superior::before{left:200px;width:140px;transform-origin:left;animation:dibujarLineaSupIzq 2s ease-out forwards}
    .conector.visible .fila.superior::after{left:340px;width:140px;transform-origin:right;animation:dibujarLineaSupDer 2s ease-out forwards}
    .nodo.rama::after{ content:"";position:absolute;top:100%;left:50%;width:4px;height:100px;background: linear-gradient(to bottom, var(--rojo), transparent);transform-origin:top center;transform:scaleY(0);z-index:-1 }
    .conector.visible .nodo.rama::after{animation:dibujarRama 1.2s ease-out forwards 2s}
    .fila.inferior{margin-top:100px;justify-content:space-between;overflow:visible;position:relative}
    .fila.inferior::after{ content:"";position:absolute;top:50%;left:50%;width:6px;height:100px;background:linear-gradient(to bottom, var(--rojo), var(--rojo2), transparent);transform-origin:top;transform:scaleY(0);z-index:-1;box-shadow:0 0 10px rgba(232,85,100,.5) }
    .conector.visible .fila.inferior::after{animation:dibujarLineaAbajo 1.6s ease-out forwards 3.2s}
    .nodo.join-left::after,.nodo.join-right::after{ content:"";position:absolute;top:50%;height:4px;background: linear-gradient(to right, transparent, var(--rojo), transparent);width:140px;transform:scaleX(0);z-index:-2 }
    .conector.visible .nodo.join-left::after{left:100%;transform-origin:left;animation:dibujarLineaIzq 2.4s ease-out forwards 2.2s}
    .conector.visible .nodo.join-right::after{right:100%;transform-origin:right;animation:dibujarLineaDer 2.4s ease-out forwards 2.2s}
    @keyframes dibujarLineaSupIzq {to{transform:scaleX(1)}} @keyframes dibujarLineaSupDer {to{transform:scaleX(1)}}
    @keyframes dibujarRama {to{transform:scaleY(1)}} @keyframes dibujarLineaIzq {to{transform:scaleX(1)}}
    @keyframes dibujarLineaDer {to{transform:scaleX(1)}} @keyframes dibujarLineaAbajo {to{transform:scaleY(1)}}
    @keyframes brilloLinea{ 0%,100%{transform:translateX(-50%) translateY(0);opacity:1} 50%{transform:translateX(-50%) translateY(100px);opacity:0.3} }

    /* CONTENIDO PRINCIPAL (secciones hermanas de #inicio) */
    .wrapper{max-width:1100px;margin:0 auto;padding:36px 20px;perspective:1200px}
    .section{margin-bottom:36px}
    .section-title{text-align:center;font-size:28px;font-weight:800;color:var(--rojo);margin:8px 0 20px}
    .divider{height:2px;background:var(--rojo);opacity:.6;margin:28px 0}

    .cards-row{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:var(--gap)}
    .cards-row.cols-3{grid-template-columns:repeat(3,minmax(280px,1fr))}
    .cards-row.cols-3 .card:first-child{grid-column:2;justify-self:center}
    @media (max-width:900px){ .cards-row.cols-3{grid-template-columns:repeat(2,minmax(260px,1fr))} .cards-row.cols-3 .card:first-child{grid-column:1 / -1} }
    @media (max-width:560px){.cards-row.cols-3{grid-template-columns:1fr}}

    .card{ position:relative;height:var(--card-h);background:#fff;border-radius:var(--radius);
      border:1px solid #efe9e9;overflow:hidden;display:flex;flex-direction:column;
      box-shadow:var(--elev0);transition:box-shadow .25s ease,transform .6s ease,opacity .6s ease;
      transform-style:preserve-3d;opacity:0;transform:translateZ(-300px) scale(.7) }
    .card:hover{box-shadow:var(--elev1);transform:scale(1.03)}
    .card.in{opacity:1;transform:translateZ(0) scale(1)}

    .card-header{ height:var(--hdr-h);display:flex;align-items:center;justify-content:space-between;
      padding:0 16px;background:var(--rojo);color:#fff;font-weight:800;letter-spacing:.2px }
    .card-header:hover{background:linear-gradient(90deg,var(--rojo) 0%,var(--rojo2) 100%)}
    .card-icon{width:26px;height:26px;display:flex;align-items:center;justify-content:center;color:#fff}
    .card-icon svg{width:100%;height:100%;fill:currentColor}
    .card-body{ flex:1;padding:12px 16px 16px;font-size:14px;line-height:1.45;color:#2f3845;
      overflow:hidden;display:-webkit-box;-webkit-line-clamp:6;-webkit-box-orient:vertical }

    @media (prefers-reduced-motion:reduce){
      *{animation:none!important; transform:none!important; opacity:1!important}
    }
    @media (max-width:640px){
      :root{--card-h:280px;--hdr-h:70px;--gap:18px}
      .section-title{font-size:24px}
    }
  </style>
</head>
<body>

  <!-- Header fijo -->
  <header class="site" role="banner">
    <div class="navwrap">
      <a class="logo" href="#inicio">
        <img src="https://lh3.googleusercontent.com/d/109rN8IqcM3AyWK6NRWNhouL-tqI03QXR=w1000" alt="Logo GeoVivienda">
        <span>GeoVivienda</span>
      </a>
      <nav aria-label="Principal">
        <ul>
          <li><a class="active" href="#inicio">Inicio</a></li>
          <li><a href="#geovisor">Geovisor</a></li>
          <li><a href="#mvcs">VMCS</a></li>
          <li><a href="#vmvu">VMVU</a></li>
          <li><a href="#sg">Riesgos</a></li>
          <li><a href="#analisis">Análisis SIG</a></li>
        </ul>
      </nav>
      <a class="btn" href="#ingresar">Ingresar</a>
    </div>
  </header>

  <!-- SECCIÓN INICIO (hero + info + cifras + ramificación) -->
  <section id="inicio" class="cover">
    <div class="container">
      <div>
        <h1 class="title">
          <span style="--i:1">Plataforma</span><span style="--i:2">GIS</span><span style="--i:3">del</span>
          <span style="--i:4">Ministerio</span><span style="--i:5">de</span><span style="--i:6">Vivienda,</span>
          <span style="--i:7">Construcción</span><span style="--i:8">y</span><span style="--i:9">Saneamiento</span>
        </h1>
        <p class="subtitle">Accede a datos geográficos y estadísticos actualizados sobre vivienda, agua, saneamiento, titulación y planificación urbana. Una herramienta del MVCS al servicio de la ciudadanía y los gobiernos locales.</p>
        <div class="actions">
          <a class="btn" href="#geovisor">Geovisor</a>
          <a class="btn ghost" href="#datos">Datos abiertos</a>
        </div>
      </div>
      <div class="art">
        <img class="floaty" src="https://lh3.googleusercontent.com/d/1yMPY_3miMHPYv6qXHp3013u3QHHf-0Ec=w1000" alt="Mapa Perú decorativo" />
      </div>
    </div>

    <div class="info-apartado">
      El Geovivienda, es el medio oficial para el acceso, uso e intercambio de información espacial que genera
      el <strong>Ministerio de Vivienda, Construcción y Saneamiento</strong>, aprobado mediante la R.M. Nº087-2019-VIVIENDA.
    </div>

    <div class="stats">
      <div class="wrap">
        <h2>Nuestras Cifras</h2>
        <div class="kpis">
          <div class="counter" data-value="15333"><div class="slot" aria-label="Cobertura de Agua"></div><div class="label">Cobertura de Agua</div></div>
          <div class="kpi-sep">·</div>
          <div class="counter" data-value="14426"><div class="slot" aria-label="Proyectos Culminados"></div><div class="label">Proyectos Culminados</div></div>
          <div class="kpi-sep">·</div>
          <div class="counter" data-value="427311"><div class="slot" aria-label="Conexiones de agua nuevas"></div><div class="label">Conexiones de agua nuevas</div></div>
          <div class="kpi-sep">·</div>
          <div class="counter" data-value="157499"><div class="slot" aria-label="Conexiones de Alcantarillado"></div><div class="label">Conexiones de Alcantarillado</div></div>
        </div>
        <div class="footnote">Actualizado al 03:30 PM -05, 22/09/2025</div>
      </div>
    </div>

    <div class="conector">
      <div class="fila superior">
        <div class="nodo rama"><img src="https://lh3.googleusercontent.com/d/1i8CwW-eOf-Pd2ANa6o7X6yaFOcP5KpC7=w1000" alt="Imagen A"></div>
        <div class="nodo"><img src="https://lh3.googleusercontent.com/d/1Ht4cpFniu4yNOJ-M3A003PSEmo89fsVk=w1000" alt="Imagen B"></div>
        <div class="nodo rama"><img src="https://lh3.googleusercontent.com/d/16PFDGwh-xesWMdmsq_SpXgwwqwUiKfBk=w1000" alt="Imagen C"></div>
      </div>
      <div class="fila inferior">
        <div class="nodo join-left"><img src="https://lh3.googleusercontent.com/d/1Yg8K4w6hDMz_EZ8n6otQNAmFIPB16xCG=w1000" alt="Imagen D"></div>
        <div class="nodo join-right"><img src="https://lh3.googleusercontent.com/d/1y0YcBuWlZGH7ulNQEzgyGqvIk9IxH34a=w1000" alt="Imagen E"></div>
      </div>
    </div>
  </section>

  <!-- CONTENIDO PRINCIPAL (secciones hermanas) -->
  <div class="wrapper">
    <!-- GEOVISOR -->
    <div class="section geovisor-stage" id="geovisor">
      <h2 class="section-title">Geovisor</h2>
      <div class="cards-row cols-3">
        <div class="card" id="visor">
          <div class="card-header"><span>Visor Cartográfico</span><div class="card-icon"><svg viewBox="0 0 24 24" width="24" height="24"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5z" fill="#fff"/></svg></div></div>
          <div class="card-body">Síntesis de brechas e intervenciones en vivienda, titulación, acceso a servicios básicos y acceso a infraestructura y equipamiento urbano.</div>
        </div>
      </div>
    </div>

    <div class="divider"></div>

    <!-- CONSTRUCCIÓN Y SANEAMIENTO -->
    <div class="section" id="mvcs">
      <h2 class="section-title">Construcción y Saneamiento</h2>
      <div class="cards-row">
        <div class="card"><div class="card-header"><span>Geovivienda Verde</span><div class="card-icon">🌿</div></div><div class="card-body">Plataforma integral diseñada para visualizar y gestionar información espacial relacionada con la gestión ambiental.</div></div>
        <div class="card"><div class="card-header"><span>Visor de mapas DATASS</span><div class="card-icon">🗺️</div></div><div class="card-body">Información georreferenciada sobre abastecimiento de agua y saneamiento en el ámbito rural y otra información institucional.</div></div>
        <div class="card"><div class="card-header"><span>Tablero de control DATASS</span><div class="card-icon">📊</div></div><div class="card-body">Cuadros y gráficos dinámicos sobre acceso a servicios de saneamiento, prestadores y sistemas de agua.</div></div>
      </div>
    </div>

    <div class="divider"></div>

    <!-- VIVIENDA Y URBANISMO -->
    <div class="section" id="vmvu">
      <h2 class="section-title">Vivienda y Urbanismo</h2>
      <div class="cards-row">
        <div class="card"><div class="card-header"><span>Soluciones de vivienda</span><div class="card-icon">🏠</div></div><div class="card-body">Promueve el acceso a viviendas dignas y sostenibles para familias y comunidades.</div></div>
        <div class="card"><div class="card-header"><span>Títulos inscritos</span><div class="card-icon">📬</div></div><div class="card-body">Información de los asuntos inscritos en el registro de catastro, titulación y registro inmobiliario.</div></div>
        <div class="card"><div class="card-header"><span>Geoplan</span><div class="card-icon">🧭</div></div><div class="card-body">Instrumento que impulsa la planificación territorial con enfoques de desarrollo sostenible y prevención del riesgo de desastres.</div></div>
        <div class="card"><div class="card-header"><span>Visor SICCEP</span><div class="card-icon">🗂️</div></div><div class="card-body">Información georreferenciada de proyectos de inversión en vivienda.</div></div>
        <div class="card"><div class="card-header"><span>Bono familiar habitacional</span><div class="card-icon">🏡</div></div><div class="card-body">Subsidio que permite a las familias adquirir, construir o mejorar su vivienda.</div></div>
      </div>
    </div>

    <div class="divider"></div>

    <!-- GESTIÓN DEL RIESGO DE DESASTRES -->
    <div class="section" id="sg">
      <h2 class="section-title">Gestión del Riesgo de Desastres</h2>
      <div class="cards-row">
        <div class="card"><div class="card-header"><span>Zonas expuestas a peligro</span><div class="card-icon">⚠️</div></div><div class="card-body">Áreas expuestas a peligros naturales o ambientales mediante análisis geográficos e históricos.</div></div>
        <div class="card"><div class="card-header"><span>Microzonificación sísmica</span><div class="card-icon">🌐</div></div><div class="card-body">Estudios geotécnicos y sismológicos que evalúan la respuesta del suelo ante eventos sísmicos.</div></div>
        <div class="card"><div class="card-header"><span>Visor Georiesgo</span><div class="card-icon">🧱</div></div><div class="card-body">Visualiza y evalúa riesgos geológicos, deslizamientos y movimientos sísmicos.</div></div>
      </div>
    </div>

    <div class="divider"></div>

    <!-- HERRAMIENTAS DE ANÁLISIS Y SEGUIMIENTO -->
    <div class="section" id="analisis">
      <h2 class="section-title">Herramientas de Análisis y Seguimiento</h2>
      <div class="cards-row">
        <div class="card"><div class="card-header"><span>Monitoreo de proyectos</span><div class="card-icon">📈</div></div><div class="card-body">Seguimiento y evaluación de proyectos de inversión para asegurar su correcta ejecución.</div></div>
        <div class="card"><div class="card-header"><span>Proyectos en inversión</span><div class="card-icon">🔁</div></div><div class="card-body">Información georreferenciada sobre proyectos en ejecución y planificación.</div></div>
        <div class="card"><div class="card-header"><span>Transferencias</span><div class="card-icon">⚙️</div></div><div class="card-body">Herramienta en desarrollo para gestionar transferencias y asignaciones de recursos (en mantenimiento).</div></div>
      </div>
    </div>
  </div>

  <script>
  /* ===== Contadores – franja "Nuestras Cifras" ===== */
  (function(){
    const SEP='.'; const duration=1400; const extraSpin=6; const easeOut=t=>1-Math.pow(1-t,3);
    const counters=document.querySelectorAll('.stats .counter');
    const formatES=num => num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, SEP);
    function buildDigits(slot, str){ slot.innerHTML=''; for(const ch of str){ if(ch===SEP){ const s=document.createElement('span'); s.className='sep'; s.textContent='.'; slot.appendChild(s); }else{ const d=document.createElement('span'); d.className='digit'; d.dataset.target=ch; d.textContent='0'; slot.appendChild(d); } } }
    function spinDigit(el, finalDigit, idx){
      const start=performance.now(); const spins=extraSpin+idx; const total=spins*10+Number(finalDigit);
      function frame(now){ const t=Math.min(1,(now-start)/(duration+idx*100)); const eased=easeOut(t); const step=Math.floor(total*eased); el.textContent=(step%10).toString();
        if(t<1) requestAnimationFrame(frame); else el.textContent=finalDigit; }
      requestAnimationFrame(frame);
    }
    function runCounter(counter){
      const val = Number(counter.dataset.value || '0'); const slot = counter.querySelector('.slot');
      buildDigits(slot, formatES(val)); slot.querySelectorAll('.digit').forEach(d=>d.textContent=Math.floor(Math.random()*10));
      let i=0; for(const node of slot.children){ if(node.classList && node.classList.contains('digit')){ spinDigit(node, node.dataset.target, i++); } }
    }
    const stats=document.querySelector('.stats'); let fired=false;
    const io=new IntersectionObserver(entries=>{ entries.forEach(e=>{ if(e.isIntersecting && !fired){ fired=true; counters.forEach(runCounter); io.disconnect(); } }); },{threshold:.25});
    if(stats) io.observe(stats);
  })();

  /* ===== Animación del Geovisor ===== */
  window.addEventListener('DOMContentLoaded', () => {
    const stage = document.querySelector('.geovisor-stage');
    const visor = document.getElementById('visor');
    const cards = Array.from(document.querySelectorAll('.card'));
    if (!('IntersectionObserver' in window)) {
      cards.forEach(c => c.classList.add('in'));
    } else {
      const io = new IntersectionObserver((entries)=>{ 
        entries.forEach((e)=>{ if(e.isIntersecting){ const idx = cards.indexOf(e.target); e.target.style.transitionDelay = (idx % 8) * 100 + 'ms'; e.target.classList.add('in'); io.unobserve(e.target); } }); 
      }, {threshold:0.15});
      cards.forEach(c => io.observe(c));
    }
    setTimeout(() => { stage?.classList.add('active'); visor.classList.add('glow'); setTimeout(() => visor.classList.remove('glow'), 2000); }, 4000);
  });

  /* ===== Menú activo preciso (elige la sección más visible y la más cercana al top) ===== */
  (function(){
    const header = document.querySelector('header.site');
    const HEADER_H = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--header-h')) || header.offsetHeight || 80;
    const ids = ['inicio','geovisor','mvcs','vmvu','sg','analisis'];
    const sections = ids.map(id => document.getElementById(id)).filter(Boolean);
    const links = Array.from(document.querySelectorAll('nav a'));

    const setActive = (id)=>{
      links.forEach(a=>{
        const match = a.getAttribute('href') === '#' + id;
        a.classList.toggle('active', match);
        if(match) a.setAttribute('aria-current','page'); else a.removeAttribute('aria-current');
      });
    };

    // Sombra header al hacer scroll
    const onScrollShadow = ()=>{ if(window.scrollY > 8) header.classList.add('scrolled'); else header.classList.remove('scrolled'); };
    onScrollShadow(); window.addEventListener('scroll', onScrollShadow, {passive:true});

    if('IntersectionObserver' in window){
      const visible = new Map(); // id -> ratio
      const io = new IntersectionObserver((entries)=>{
        entries.forEach(e=>{
          const id = e.target.id;
          visible.set(id, e.isIntersecting ? e.intersectionRatio : 0);
        });

        // 1) Mayor ratio visible
        let bestId = ids[0], bestRatio = -1;
        for(const id of ids){
          const r = visible.get(id) || 0;
          if(r > bestRatio){ bestRatio = r; bestId = id; }
        }
        // 2) Si el ratio no es concluyente, usar el más cercano al borde superior bajo el header
        if(bestRatio < 0.55){
          let closestId = ids[0], bestDelta = Infinity;
          for(const id of ids){
            const el = document.getElementById(id); if(!el) continue;
            const top = el.getBoundingClientRect().top;
            const delta = Math.abs(top - HEADER_H - 8);
            if(delta < bestDelta) { bestDelta = delta; closestId = id; }
          }
          bestId = closestId;
        }
        setActive(bestId);
      },{
        root:null,
        rootMargin: `-${HEADER_H+6}px 0px -60% 0px`,
        threshold: [0,0.25,0.5,0.75,1]
      });
      sections.forEach(s=>io.observe(s));
    }else{
      // Fallback por top más cercano
      const onScroll = ()=>{
        let closestId = ids[0], bestDelta = Infinity;
        for(const id of ids){
          const el = document.getElementById(id); if(!el) continue;
          const top = el.getBoundingClientRect().top;
          const delta = Math.abs(top - HEADER_H - 8);
          if(delta < bestDelta) { bestDelta = delta; closestId = id; }
        }
        setActive(closestId);
      };
      onScroll();
      window.addEventListener('scroll', onScroll, {passive:true});
    }

    // Activo inmediato al click
    links.forEach(a=>{
      a.addEventListener('click', ()=>{ const id = a.getAttribute('href').slice(1); setActive(id); });
    });
  })();

  /* ===== Ramificación visible ===== */
  window.addEventListener('DOMContentLoaded', () => {
    const conector = document.querySelector('.conector');
    if (!conector) return;
    if (!('IntersectionObserver' in window)) {
      conector.classList.add('visible');
    } else {
      const io = new IntersectionObserver((entries) => {
        entries.forEach((e) => { if (e.isIntersecting) { conector.classList.add('visible'); io.unobserve(conector); } });
      }, {threshold: 0.15});
      io.observe(conector);
    }
  });
  </script>
</body>
</html>
