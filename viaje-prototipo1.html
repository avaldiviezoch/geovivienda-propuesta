<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Itinerario · Lima – Madrid – París – Madrid – Lima (6–17 nov 2025)</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&display=swap" rel="stylesheet">
<meta name="color-scheme" content="light dark"/>
<style>
  :root{
    /* Oscuro por defecto */
    --bg:#080e1a; --ink:#e9f2ff; --muted:#a8b4cc;
    --glass: color-mix(in srgb, #ffffff 12%, transparent);
    --card: color-mix(in srgb, #ffffff 8%, transparent);
    --stroke: color-mix(in srgb, #99b1ff 20%, transparent);
    --brand:#6b8cff; --brand2:#a66bff;
    --ok:#34d399; --warn:#f59e0b; --danger:#f87171;
    --radius:12px; --maxw:1100px; --hdr:100px;
    --shadow:0 8px 24px rgba(0,0,0,.4);
    --bg-grad1: radial-gradient(1000px 1000px at 5% -5%, #162040 0, transparent 65%);
    --bg-grad2: radial-gradient(1000px 1000px at 105% 15%, #2e1a45 0, transparent 60%);
  }
  :root[data-theme="light"]{
    --bg:#f5f7ff; --ink:#0a1120; --muted:#5a6688;
    --glass: color-mix(in srgb, #000 8%, transparent);
    --card:#ffffffe6; --stroke:#d0d9ff;
    --brand:#2563eb; --brand2:#9333ea;
    --shadow:0 8px 24px rgba(0,0,0,.1);
    --bg-grad1: radial-gradient(1000px 1000px at 5% -5%, #e0e7ff 0, transparent 65%);
    --bg-grad2: radial-gradient(1000px 1000px at 105% 15%, #ede4ff 0, transparent 60%);
  }

  *{box-sizing:border-box}
  html,body{
    margin:0;height:100%;
    font-family:Inter,system-ui,Segoe UI,Roboto,Arial;
    background: var(--bg-grad1), var(--bg-grad2), var(--bg);
    color:var(--ink);overflow-x:hidden
  }
  a{color:var(--brand);text-decoration:none}
  a:hover{text-decoration:underline}
  button{font:inherit;cursor:pointer}

  /* COVER SECTION */
  .cover{
    width:min(100% - 24px, var(--maxw));
    margin:40px auto 40px;
    text-align:center;
    display:grid;
    gap:20px;
    padding:30px 0;
    background:radial-gradient(circle at 50% 50%, rgba(0,0,0,.25), var(--bg) 70%);
  }
  .cover__title{
    font-size:40px;
    font-weight:900;
    letter-spacing:1.2px;
    margin:0;
    color:var(--ink);
    text-shadow:0 4px 12px rgba(0,0,0,.3);
  }
  .cover__faces{
    display:flex;
    justify-content:center;
    gap:28px;
    margin-top:16px;
  }
  .cover__head{
    width:130px;
    height:130px;
    display:block;
    object-fit:contain;
    filter: drop-shadow(0 8px 20px rgba(0,0,0,.45));
    transform-origin: bottom center;
    animation: neck-tilt 3.5s ease-in-out infinite;
  }
  .cover__head--lag{ animation-delay: 1s }
  @keyframes neck-tilt{
    0%   { transform: rotate(0deg) }
    25%  { transform: rotate(8deg) }
    50%  { transform: rotate(0deg) }
    75%  { transform: rotate(-8deg) }
    100% { transform: rotate(0deg) }
  }

  /* HEADER */
  .hdr{
    position:sticky;top:0;z-index:60;height:var(--hdr);
    display:flex;align-items:center;justify-content:center;
    backdrop-filter: blur(12px);
    background:linear-gradient(180deg, color-mix(in srgb, var(--bg) 75%, transparent), color-mix(in srgb, var(--bg) 25%, transparent));
    border-bottom:1px solid var(--stroke)
  }
  .hdr__in{
    width:min(100% - 24px, var(--maxw));
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:12px;
  }
  .title{display:flex;align-items:center;gap:12px;min-width:0;flex:1}
  .title__text{display:grid;gap:3px;min-width:0;flex:1 1 auto}
  .title h1{margin:0;font-weight:900;font-size:18px;letter-spacing:.2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  .title p{margin:0;color:var(--muted);font-size:12px}

  .hdr__actions{display:flex;gap:6px;flex-wrap:wrap;justify-content:flex-end}
  .btn{height:36px;padding:0 12px;border:1px solid var(--stroke);border-radius:10px;color:var(--ink);
       background:linear-gradient(180deg, color-mix(in srgb, var(--card) 65%, transparent), transparent);
       transition:all .2s ease}
  .btn:hover{border-color:color-mix(in srgb, var(--brand) 50%, var(--stroke));background:color-mix(in srgb, var(--brand) 15%, var(--card))}
  .btn--ghost{border:1px solid var(--stroke);background:transparent}

  /* Top blocks */
  .top{width:min(100% - 24px, var(--maxw));margin:16px auto;display:grid;gap:12px}
  .card{background:var(--card);border:1px solid var(--stroke);border-radius:12px;box-shadow:var(--shadow);position:relative;overflow:hidden}
  .card::after{content:"";position:absolute;inset:-15%;background:
    radial-gradient(500px 180px at 0% 0%, color-mix(in srgb, var(--brand) 15%, transparent), transparent 65%),
    radial-gradient(700px 220px at 100% -15%, color-mix(in srgb, var(--brand2) 15%, transparent), transparent 65%);pointer-events:none;opacity:0.7}

  .filters{padding:12px;display:flex;gap:6px;flex-wrap:wrap;justify-content:center}
  .tag{padding:8px 14px;border-radius:999px;border:1px solid var(--stroke);background:color-mix(in srgb, var(--glass) 75%, transparent);font-weight:600;font-size:13px;transition:all .2s ease}
  .tag:hover{background:linear-gradient(90deg, color-mix(in srgb, var(--brand) 20%, var(--glass)), color-mix(in srgb, var(--brand2) 20%, var(--glass)));border-color:color-mix(in srgb, var(--brand) 40%, var(--stroke));transform:scale(1.05)}
  .tag.active{background:linear-gradient(90deg, var(--brand), var(--brand2));border:none;color:#fff;transform:scale(1.02)}

  .summary{padding:16px;display:grid;gap:12px}
  .row{display:flex;gap:10px;align-items:center;justify-content:space-between;flex-wrap:wrap}
  .kpis{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}
  @media (max-width:680px){.kpis{grid-template-columns:repeat(2,1fr)}}
  .kpi{padding:10px;border:1px dashed var(--stroke);border-radius:10px;display:grid;gap:5px;background:color-mix(in srgb, var(--glass) 60%, transparent)}
  .kpi b{font-size:18px}

  /* Itinerario */
  .days{width:min(100% - 24px, var(--maxw));margin:10px auto 50px;display:grid;gap:10px}
  .day{border:1px solid var(--stroke);border-radius:12px;background:color-mix(in srgb, #0c1528 70%, transparent);overflow:hidden;transition:box-shadow .3s ease, transform .2s ease}
  .day:hover{box-shadow:0 6px 20px rgba(0,0,0,.25);transform:translateY(-2px)}
  :root[data-theme="light"] .day{background:#ffffffe6}
  .day__hdr{display:flex;align-items:center;gap:8px;padding:10px 12px;background:color-mix(in srgb, var(--glass) 70%, transparent);border-bottom:1px solid var(--stroke)}
  .date{font-weight:900;letter-spacing:.2px;font-size:15px}
  .city{color:var(--muted);font-size:13px;margin-left:auto}
  .state{font-size:11px;padding:5px 9px;border-radius:8px;border:1px solid var(--stroke);font-weight:600}
  .state.ok{color:#aaffc7;border-color:var(--ok)}
  .state.pend{color:#ffe2a6;border-color:var(--warn)}
  .state.fly{color:#ffcad2;border-color:var(--danger)}

  .events{display:grid;gap:8px;padding:10px}
  .ev{display:grid;gap:8px;padding:10px;border:1px solid var(--stroke);border-radius:10px;background:color-mix(in srgb, var(--glass) 60%, transparent);transition:transform .25s ease,border-color .25s ease,box-shadow .25s ease}
  .ev:hover{transform:translateY(-2px) scale(1.005);border-color:color-mix(in srgb, var(--brand) 50%, var(--stroke));box-shadow:0 6px 20px rgba(35,76,184,.2)}
  .ev__row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  .ev h4{margin:0;font-size:14px;display:flex;align-items:center;gap:6px}
  .pill{height:24px;display:inline-flex;align-items:center;gap:5px;padding:0 9px;border-radius:999px;font-size:11px;border:1px solid var(--stroke);color:var(--muted);background:color-mix(in srgb, var(--glass) 60%, transparent)}
  .pill.ok{border-color:color-mix(in srgb, var(--ok) 60%, var(--stroke))}
  .pill.pend{border-color:color-mix(in srgb, var(--warn) 60%, var(--stroke))}
  .pill.fly{border-color:color-mix(in srgb, var(--danger) 60%, var(--stroke))}
  .when{color:#2b7fff}
  .where{color:#7f63ff}
  .act{margin-left:auto;display:flex;gap:5px;flex-wrap:wrap}
  .btn-mini{height:26px;padding:0 7px;border-radius:8px;border:1px solid var(--stroke);background:color-mix(in srgb, var(--glass) 55%, transparent);color:var(--ink);font-size:11px;transition:all .2s ease}
  .btn-mini:hover{background:color-mix(in srgb, var(--brand) 25%, transparent);border-color:var(--brand);transform:scale(1.03)}
  .mini-map{font-size:10px;opacity:.85}
  .icon{width:20px;height:20px;display:inline-grid;place-items:center;border-radius:6px;background:linear-gradient(180deg, color-mix(in srgb, var(--brand) 25%, transparent), color-mix(in srgb, var(--brand2) 15%, transparent));border:1px solid color-mix(in srgb, var(--stroke) 85%, transparent);box-shadow:inset 0 0 8px rgba(255,255,255,.15)}
  .ico{font-size:13px;filter:drop-shadow(0 1px 4px rgba(0,0,0,.3))}
  .muted{color:var(--muted)}

  /* Tools */
  .tools{width:min(100% - 24px, var(--maxw));margin:0 auto 40px;display:grid;grid-template-columns:1fr;gap:12px}
  @media (min-width:980px){.tools{grid-template-columns:1.3fr .7fr}}
  .panel{padding:16px;display:grid;gap:12px;border-radius:12px}
  textarea{width:100%;min-height:140px;resize:vertical;padding:10px;border-radius:10px;border:1px solid var(--stroke);background:color-mix(in srgb, #0e172e 75%, transparent);color:var(--ink);transition:border-color .2s ease}
  textarea:focus{border-color:var(--brand);outline:none}
  :root[data-theme="light"] textarea{background:#fff;color:#0a1120}
  .checklist{display:grid;gap:8px}
  .check{display:flex;gap:8px;align-items:center;padding:8px;border:1px solid var(--stroke);border-radius:10px;background:color-mix(in srgb, var(--glass) 60%, transparent);transition:background .2s ease}
  .check:hover{background:color-mix(in srgb, var(--glass) 70%, transparent)}
  .check input{width:16px;height:16px}

  /* reveal */
  .reveal{opacity:0;transform:translateY(12px);transition:opacity .5s ease, transform .5s ease}
  .reveal.show{opacity:1;transform:none}

  /* print */
  @media print{
    .hdr, .filters, .hdr__actions{display:none !important}
    body{background:#fff;color:#111}
    .card, .day{box-shadow:none;border:1px solid #ddd}
    .day__hdr{background:#f6f8ff;-webkit-print-color-adjust:exact;print-color-adjust:exact}
    a{color:#000;text-decoration:none}
  }
</style>
</head>
<body>

<section class="cover">
  <h1 class="cover__title">EUROTRIP ITINERARIO VIAJE MADRID PARÍS</h1>
  <div class="cover__faces">
    <img class="cover__head" src="https://lh3.googleusercontent.com/d/1E82o__-jHJmWwubokZcy2WgMVBXha4LO=w1000" alt="Antonio">
    <img class="cover__head cover__head--lag" src="https://lh3.googleusercontent.com/d/1GfkwGMzG9RTNaMLWdUxzxkvdTBWmFIxA=w1000" alt="Pareja">
  </div>
</section>

<header class="hdr">
  <div class="hdr__in">
    <div class="title">
      <div class="title__text">
        <h1>Itinerario — Lima · Madrid · París · Madrid · Lima</h1>
        <p>6–17 noviembre 2025 · 2 personas</p>
      </div>
    </div>

    <div class="hdr__actions">
      <button class="btn" id="btnTheme">🌙/☀️ Tema</button>
      <button class="btn btn--ghost" id="btnPrint">🖨️ PDF</button>
      <button class="btn btn--ghost" id="btnReset">↺ Reset notas</button>
    </div>
  </div>
</header>

<section class="top">
  <div class="card">
    <div class="filters" id="filters">
      <button class="tag active" data-filter="all">🔎 Todos</button>
      <button class="tag" data-filter="Madrid">🏙️ Madrid</button>
      <button class="tag" data-filter="París">🗼 París</button>
      <button class="tag" data-filter="Versalles">👑 Versalles</button>
      <button class="tag" data-filter="Vuelo">✈️ Vuelos</button>
      <button class="tag" data-filter="Confirmado">✅ Confirmado</button>
      <button class="tag" data-filter="Pendiente">⏳ Pendiente</button>
      <button class="tag" data-filter="Museo">🖼️ Museos</button>
      <button class="tag" data-filter="Crucero">🚤 Crucero</button>
      <button class="tag" data-filter="Parque">🎢 Parque</button>
      <button class="tag" data-filter="Paseo">🚶 Paseo</button>
      <button class="tag" data-filter="Tour">🏟️ Tour</button>
      <button class="tag" data-filter="Monumento">🏛️ Monumento</button>
      <button class="tag" data-filter="Cultura">📚 Cultura</button>
      <button class="tag" data-filter="Info">ℹ️ Info</button>
    </div>
  </div>

  <div class="card summary reveal">
    <div class="row">
      <div>
        <div style="opacity:.9;font-weight:900;letter-spacing:.3px">Resumen de viaje</div>
        <div class="muted" style="font-size:13px">Fechas: <b>6–17 nov 2025</b> · Base: <b>Saint-Germain-en-Laye</b></div>
      </div>
      <div style="display:flex;gap:8px;flex-wrap:wrap">
        <span class="kpi" style="display:inline-grid;min-width:160px"><span class="muted" style="font-size:12px">Entradas confirmadas</span><b>6</b></span>
        <span class="kpi" style="display:inline-grid;min-width:160px"><span class="muted" style="font-size:12px">Pendientes</span><b>2</b></span>
      </div>
    </div>
    <div class="kpis">
      <div class="kpi"><span class="muted" style="font-size:12px">Días totales</span><b>12</b></div>
      <div class="kpi"><span class="muted" style="font-size:12px">Ciudades</span><b>Madrid · París</b></div>
      <div class="kpi"><span class="muted" style="font-size:12px">Vuelos planificados</span><b>3</b></div>
    </div>
  </div>
</section>

<main class="days" id="days"></main>

<section class="tools">
  <div class="card panel reveal">
    <h3>Notas personales (guardadas en este navegador)</h3>
    <textarea id="notes" placeholder="Escribe ideas, presupuestos, recordatorios…"></textarea>
    <div style="display:flex;gap:8px;justify-content:flex-end">
      <button class="btn" id="saveNotes">💾 Guardar</button>
    </div>
  </div>
  <div class="card panel reveal">
    <h3>Checklist de entradas / tareas</h3>
    <div class="checklist" id="checklist"></div>
  </div>
</section>

<script>
/* ===== Tema claro/oscuro (persistente) ===== */
(function(){
  const saved=localStorage.getItem("trip.theme");
  if(saved){ document.documentElement.setAttribute("data-theme", saved); }
})();
document.getElementById('btnTheme').addEventListener('click',()=>{
  const cur=document.documentElement.getAttribute('data-theme')||'dark';
  const next= cur==='light' ? 'dark' : 'light';
  document.documentElement.setAttribute('data-theme', next);
  localStorage.setItem('trip.theme', next);
});

/* ===== Íconos ===== */
const ICONS={"Vuelo":"✈️","Tour":"🏟️","Museo":"🖼️","Monumento":"🏛️","Paseo":"🚶","Parque":"🎢","Crucero":"🚤","Cultura":"📚","Info":"ℹ️"};

/* ===== Datos ===== */
const DAYS=[
  {date:"Jue · 6 nov 2025",city:"Vuelo",state:"Confirmado",items:[{title:"Vuelo Lima → Madrid",when:"23:05 (6 nov) – 18:30 (7 nov) · 11h 30m",where:"LIM → MAD (Barajas)",type:"Vuelo",state:"Confirmado",startISO:"2025-11-06T23:05:00",endISO:"2025-11-07T18:30:00",tz:"Europe/Madrid",details:"Noche en vuelo. Llegada el 7 nov 18:30.",links:[]}]},
  {date:"Vie · 7 nov 2025",city:"Madrid",state:"Info",items:[{title:"Llegada a Madrid + Check-in",when:"18:30",where:"Gran Vía / Chamberí",type:"Info",state:"Confirmado",startISO:"2025-11-07T18:30:00",endISO:"2025-11-07T20:00:00",tz:"Europe/Madrid",details:"Cena ligera y descanso (jet lag).",links:[{label:"Mapa",url:"https://maps.google.com/?q=Gran+V%C3%ADa+Madrid"}]}]},
  {date:"Sáb · 8 nov 2025",city:"Madrid",state:"Confirmado",items:[
    {title:"Tour Santiago Bernabéu",when:"11:30 (2–3h)",where:"Estadio Santiago Bernabéu",type:"Tour",state:"Confirmado",startISO:"2025-11-08T11:30:00",endISO:"2025-11-08T13:45:00",tz:"Europe/Madrid",details:"Entrada comprada.",links:[{label:"Cómo llegar",url:"https://maps.google.com/?q=Estadio+Santiago+Bernab%C3%A9u"}]},
    {title:"Centro histórico: Plaza Mayor · Sol · San Miguel",when:"Tarde",where:"Madrid Centro",type:"Paseo",state:"Info",startISO:"2025-11-08T16:00:00",endISO:"2025-11-08T19:00:00",tz:"Europe/Madrid",details:"Atardecer en Templo de Debod opcional.",links:[{label:"Mapa",url:"https://maps.google.com/?q=Plaza+Mayor+Madrid"}]}
  ]},
  {date:"Dom · 9 nov 2025",city:"Traslado",state:"Confirmado",items:[{title:"Vuelo Madrid → París (ORY)",when:"16:30 → 18:25 (1h 55m)",where:"MAD → ORY",type:"Vuelo",state:"Confirmado",startISO:"2025-11-09T16:30:00",endISO:"2025-11-09T18:25:00",tz:"Europe/Paris",details:"Economy Lite. Traslado a Saint-Germain-en-Laye (~1h).",links:[{label:"Saint-Germain-en-Laye",url:"https://maps.google.com/?q=Saint-Germain-en-Laye"}]}]},
  {date:"Lun · 10 nov 2025",city:"París",state:"Pendiente",items:[
    {title:"Arco del Triunfo + Campos Elíseos",when:"Mañana",where:"Charles de Gaulle – Étoile",type:"Paseo",state:"Info",startISO:"2025-11-10T10:00:00",endISO:"2025-11-10T12:00:00",tz:"Europe/Paris",details:"Subida al mirador opcional.",links:[{label:"Entradas",url:"https://www.paris-arc-de-triomphe.fr/"}]},
    {title:"Torre Eiffel (cima por ascensor)",when:"Ideal 15:30–16:00",where:"Champ de Mars",type:"Monumento",state:"Pendiente",startISO:"2025-11-10T15:30:00",endISO:"2025-11-10T17:30:00",tz:"Europe/Paris",details:"Compra pendiente (web oficial). Atardecer + encendido.",links:[{label:"Comprar (oficial)",url:"https://www.toureiffel.paris/"}]}
  ]},
  {date:"Mar · 11 nov 2025",city:"Versalles",state:"Confirmado",items:[{title:"Palacio de Versalles (Pasaporte)",when:"09:30 (día completo)",where:"Château de Versailles",type:"Museo",state:"Confirmado",startISO:"2025-11-11T09:30:00",endISO:"2025-11-11T16:30:00",tz:"Europe/Paris",details:"Palacio → Jardines → Grand/Petit Trianon → Aldea de la Reina.",links:[{label:"Entradas",url:"https://billetterie.chateauversailles.fr/"}]}]},
  {date:"Mié · 12 nov 2025",city:"París",state:"Confirmado",items:[
    {title:"Museo del Louvre (entrada confirmada)",when:"11:30 → 14:30",where:"Pirámide del Louvre",type:"Museo",state:"Confirmado",startISO:"2025-11-12T11:30:00",endISO:"2025-11-12T14:30:00",tz:"Europe/Paris",details:"Ruta: Mona Lisa · Venus · Samotracia.",links:[{label:"Tus entradas",url:"https://ticket.louvre.fr/en"}]},
    {title:"Île de la Cité (Notre-Dame) + Sainte-Chapelle",when:"Tarde",where:"Cité",type:"Paseo",state:"Info",startISO:"2025-11-12T15:30:00",endISO:"2025-11-12T17:30:00",tz:"Europe/Paris",details:"Exterior de Notre-Dame, capilla gótica opcional.",links:[{label:"Sainte-Chapelle",url:"https://www.sainte-chapelle.fr/"}]},
    {title:"Montmartre + Sacré-Cœur",when:"Atardecer / noche",where:"Montmartre",type:"Paseo",state:"Info",startISO:"2025-11-12T18:30:00",endISO:"2025-11-12T20:30:00",tz:"Europe/Paris",details:"Mirador, Place du Tertre, fotos nocturnas.",links:[{label:"Mapa",url:"https://maps.google.com/?q=Montmartre"}]}
  ]},
  {date:"Jue · 13 nov 2025",city:"París",state:"Confirmado",items:[{title:"Disneyland París (entrada confirmada)",when:"8:30 (día completo)",where:"Marne-la-Vallée — Chessy",type:"Parque",state:"Confirmado",startISO:"2025-11-13T08:30:00",endISO:"2025-11-13T20:30:00",tz:"Europe/Paris",details:"Salida 6:45 (RER A ~1h15). Rope drop + show nocturno.",links:[{label:"Cómo llegar",url:"https://maps.google.com/?q=Marne-la-Vall%C3%A9e+Chessy"}]}]},
  {date:"Vie · 14 nov 2025",city:"París",state:"Pendiente",items:[
    {title:"Le Marais + Place des Vosges",when:"09:00 → 11:00",where:"Le Marais",type:"Paseo",state:"Info",startISO:"2025-11-14T09:00:00",endISO:"2025-11-14T11:00:00",tz:"Europe/Paris",details:"Boutiques, cafés y arquitectura.",links:[{label:"Mapa",url:"https://maps.google.com/?q=Le+Marais+Paris"}]},
    {title:"Museo de Orsay (entrada confirmada)",when:"11:30 → 14:30",where:"Musée d'Orsay",type:"Museo",state:"Confirmado",startISO:"2025-11-14T11:30:00",endISO:"2025-11-14T14:30:00",tz:"Europe/Paris",details:"Entrada 11:30. Impresionistas, Van Gogh, Manet. Tiempo sugerido 2.5–3h.",links:[{label:"Ubicación",url:"https://maps.google.com/?q=Mus%C3%A9e+d%27Orsay"}]},
    {title:"Galeries Lafayette (mirador)",when:"16:00 – 17:30",where:"Boulevard Haussmann",type:"Paseo",state:"Info",startISO:"2025-11-14T16:00:00",endISO:"2025-11-14T17:30:00",tz:"Europe/Paris",details:"Terraza gratuita con vista de París.",links:[{label:"Ubicación",url:"https://maps.google.com/?q=Galeries+Lafayette+Haussmann"}]},
    {title:"Crucero por el Sena con cena",when:"19:30–21:00 (recomendado)",where:"Bateaux Mouches / Parisiens",type:"Crucero",state:"Pendiente",startISO:"2025-11-14T19:30:00",endISO:"2025-11-14T21:00:00",tz:"Europe/Paris",details:"Reservar con antelación (mesa ventana si es posible).",links:[{label:"Bateaux Mouches",url:"https://www.bateaux-mouches.fr/es/reservas"},{label:"Bateaux Parisiens",url:"https://www.bateauxparisiens.com/espanol.html"}]}
  ]},
  {date:"Sáb · 15 nov 2025",city:"Traslado",state:"Confirmado",items:[{title:"Vuelo París (ORY) → Madrid",when:"17:15 → 19:15 (2h)",where:"ORY → MAD",type:"Vuelo",state:"Confirmado",startISO:"2025-11-15T17:15:00",endISO:"2025-11-15T19:15:00",tz:"Europe/Madrid",details:"Llegada ~19:30, hotel y cena ligera.",links:[]}]},
  {date:"Dom · 16 nov 2025",city:"Madrid",state:"Info",items:[{title:"Madrid libre + Museo (opcional)",when:"Día",where:"Prado o Reina Sofía",type:"Cultura",state:"Info",startISO:"2025-11-16T11:00:00",endISO:"2025-11-16T14:00:00",tz:"Europe/Madrid",details:"Compras finales y cena de despedida.",links:[{label:"Museo del Prado",url:"https://www.museodelprado.es/"},{label:"Reina Sofía",url:"https://www.museoreinasofia.es/"}]}]},
  {date:"Lun · 17 nov 2025",city:"Vuelo",state:"Confirmado",items:[{title:"Vuelo Madrid → Lima",when:"00:45 (noche del 16)",where:"MAD → LIM",type:"Vuelo",state:"Confirmado",startISO:"2025-11-17T00:45:00",endISO:"2025-11-17T12:45:00",tz:"America/Lima",details:"Check-in anticipado en Barajas.",links:[]}]}
];

/* ===== Checklist ===== */
const CHECKS=[
  {id:"eiffel",label:"Comprar Torre Eiffel (10 nov · 15:30–16:00)",url:"https://www.toureiffel.paris/"},
  {id:"sena",label:"Reservar Crucero Sena con cena (14 nov · 19:30)",url:"https://www.bateaux-mouches.fr/es/reservas"},
  {id:"metro",label:"Cargar Navigo/metro (París)",url:""},
  {id:"euros",label:"Cambiar euros (efectivo diario)",url:""},
  {id:"docs",label:"Guardar PDFs/QRs de entradas en el móvil",url:""}
];

/* ===== Utilidades ===== */
const pad=n=>n<10?("0"+n):(""+n);
function toGoogleCalendarURL({title,startISO,endISO,tz,where,details}){
  const s=new Date(startISO), e=new Date(endISO||s.getTime()+90*60000);
  const fmt=d=> d.getUTCFullYear()+pad(d.getUTCMonth()+1)+pad(d.getUTCDate())+"T"+pad(d.getUTCHours())+pad(d.getUTCMinutes())+pad(d.getUTCSeconds())+"Z";
  const p=new URLSearchParams({action:"TEMPLATE",text:title,dates:fmt(s)+"/"+fmt(e),details:details||"",location:where||"",ctz:tz||"Europe/Paris"});
  return "https://calendar.google.com/calendar/render?"+p.toString();
}
const appleMapsURL=q=>"https://maps.apple.com/?q="+encodeURIComponent(q||"Paris");
const googleMapsURL=q=>"https://www.google.com/maps/search/?api=1&query="+encodeURIComponent(q||"Paris");

function el(tag,attrs={},kids=[]){const n=document.createElement(tag);
  Object.entries(attrs).forEach(([k,v])=>{if(k==="class")n.className=v;else if(k==="text")n.textContent=v;else if(k==="html")n.innerHTML=v;else n.setAttribute(k,v);});
  (Array.isArray(kids)?kids:[kids]).forEach(k=>k&&n.appendChild(k));return n}

/* ===== Render ===== */
const daysBox=document.getElementById('days');
function renderDays(filter="all"){
  daysBox.innerHTML="";
  DAYS.forEach(day=>{
    const dayCard=el("section",{class:"day reveal","data-city":day.city,"data-state":day.state});
    const hdr=el("div",{class:"day__hdr"},[
      el("div",{class:"date",text:day.date}),
      el("div",{class:"city",text:day.city}),
      el("div",{class:"state "+(day.state==="Confirmado"?"ok":day.state==="Pendiente"?"pend":day.state==="Vuelo"?"fly":"") ,text:day.state})
    ]);
    const evBox=el("div",{class:"events"});

    day.items.forEach(ev=>{
      const match=(filter==="all")||[day.city,day.state,ev.type,ev.state].includes(filter)||
        (ev.title+ev.where).toLowerCase().includes(String(filter).toLowerCase());
      if(!match) return;

      const icon=ICONS[ev.type]||"📍";
      const row1=el("div",{class:"ev__row"},[
        el("h4",{},[
          el("span",{class:"icon"},[el("span",{class:"ico",text:icon})]),
          document.createTextNode(ev.title)
        ]),
        el("span",{class:"pill "+(ev.state==="Confirmado"?"ok":ev.state==="Pendiente"?"pend":ev.type==="Vuelo"?"fly":""),text:(ev.state==="Confirmado"?"Confirmado":ev.state==="Pendiente"?"Pendiente":ev.type)}),
        el("span",{class:"pill when",text:"🕒 "+ev.when}),
        el("span",{class:"pill where",text:"📍 "+ev.where})
      ]);

      const row2=el("div",{class:"ev__row"},[
        el("div",{class:"muted",text:ev.details||""}),
        el("div",{class:"act"},[
          ev.startISO?el("a",{href:toGoogleCalendarURL(ev),target:"_blank",class:"btn-mini",text:"➕ Google Cal"}):null,
          el("a",{href:googleMapsURL(ev.where),target:"_blank",class:"btn-mini mini-map",text:"🗺️ GMaps"}),
          el("a",{href:appleMapsURL(ev.where),target:"_blank",class:"btn-mini mini-map",text:"🍎 Maps"})
        ])
      ]);

      evBox.appendChild(el("article",{class:"ev","data-type":ev.type,"data-state":ev.state},[row1,row2]));
    });

    dayCard.append(hdr,evBox); daysBox.appendChild(dayCard);
  });
  revealObserve();
}

/* ===== Filtros ===== */
const filters=document.getElementById('filters');
filters.addEventListener('click',e=>{
  const b=e.target.closest('.tag'); if(!b) return;
  [...filters.querySelectorAll('.tag')].forEach(x=>x.classList.remove('active'));
  b.classList.add('active');
  renderDays(b.dataset.filter);
  window.scrollTo({top:document.querySelector('.days').offsetTop-60,behavior:'smooth'});
});

/* ===== Notas & Checklist ===== */
const notes=document.getElementById('notes'); const saveNotes=document.getElementById('saveNotes');
notes.value=localStorage.getItem('trip.notes')||"";
saveNotes.addEventListener('click',()=>{localStorage.setItem('trip.notes',notes.value);saveNotes.textContent="✅ Guardado";setTimeout(()=>saveNotes.textContent="💾 Guardar",1200);});
const checklist=document.getElementById('checklist');
function renderChecklist(){
  checklist.innerHTML="";
  CHECKS.forEach(item=>{
    const wrap=el("label",{class:"check"});
    const box=el("input",{type:"checkbox"});
    box.checked=(localStorage.getItem('check.'+item.id)==="1");
    box.addEventListener('change',()=>localStorage.setItem('check.'+item.id, box.checked?"1":"0"));
    const txt=el("div",{},[el("div",{text:item.label}), item.url?el("a",{href:item.url,target:"_blank",text:"Abrir enlace"}):null]);
    wrap.append(box,txt); checklist.appendChild(wrap);
  });
}

/* ===== Botones de cabecera ===== */
document.getElementById('btnPrint').addEventListener('click',()=>window.print());
document.getElementById('btnReset').addEventListener('click',()=>{ if(!confirm("¿Resetear notas y checklist?")) return; localStorage.removeItem('trip.notes'); CHECKS.forEach(i=>localStorage.removeItem('check.'+i.id)); notes.value=""; renderChecklist(); });

/* ===== Aparición ===== */
function revealObserve(){
  const io=new IntersectionObserver(es=>es.forEach(e=>{if(e.isIntersecting){e.target.classList.add('show');io.unobserve(e.target);}}),{threshold:.15});
  document.querySelectorAll('.reveal,.day').forEach(n=>io.observe(n));
}

/* ===== Init ===== */
function initChecklist(){ try{ renderChecklist(); }catch{ checklist.innerHTML='<div class="muted">Checklist no disponible en modo privado.</div>'; } }
renderDays("all"); initChecklist(); revealObserve();
</script>
</body>
</html>
